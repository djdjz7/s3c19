import{data}from"./data.js";import{createApp,reactive}from"./petite-vue.es.js";const store=reactive({data:data,selectedProvince:{details:[]},isInSelection:!1,isInitial:!0,setSelection(e){this.selectedProvince=e}});createApp({store:store}).mount();let hue=0;const updateHue=()=>{hue=(hue+.1)%360,document.documentElement.style.setProperty("--theme-hue",hue),requestAnimationFrame(updateHue)};requestAnimationFrame(updateHue),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("loading-overlay");e.style.opacity=0,setTimeout((()=>{e.remove()}),500)}));var isMenuOpen=!1;const map=document.getElementById("map"),lands=document.querySelectorAll(".land"),infoAreaTitleText=document.getElementById("info-area-title-text"),backButton=document.getElementById("back-button"),menuToggle=document.getElementById("menu-toggle"),infoAreaTitle=document.getElementById("info-area-title"),schoolWrapper=document.getElementById("school-wrapper"),provinceListItems=document.querySelectorAll(".province-list-item"),provinceList=document.getElementById("available-province-list"),menuToggleUpper=document.getElementById("menu-toggle-upper"),menuToggleMiddle=document.getElementById("menu-toggle-middle"),menuToggleLower=document.getElementById("menu-toggle-lower"),fadeLeftOutKF=[{transform:"translateX(-40px)",opacity:0}],fadeRightInKF=[{transform:"translateX(40px)",opacity:0},{transform:"translateX(0)",opacity:1}],fadeTiming={duration:250,iterations:1,fill:"both",easing:"ease-out"};function provinceClick(e,t=!1){if(store.isInitial=!1,closeMenu(!0),store.isInSelection)return;store.isInSelection=!0,backButton.style.opacity=1,menuToggle.style.opacity=0,infoAreaTitle.style.transform="";var n=e.target;map.appendChild(n),n.classList.add("selected-hold"),lands.forEach((e=>{e!==n&&(e.classList.remove("selected-hold"),e.classList.add("unselected-hold"))}));const o=n.getBoundingClientRect(),l=map.getBoundingClientRect(),i=l.width/o.width,a=l.height/o.height,s=.7*Math.min(i,a),r=(l.width-o.width)/2-o.left,c=(l.height-o.height)/2-o.top;map.style.transformOrigin=`${o.left+o.width/2}px ${o.top+o.height/2}px`,map.style.translate=`-${r}px -${c}px`,map.style.transform=`rotateX(45deg) rotateZ(12deg) scale(${s})`,infoAreaTitleText.innerText=n.getAttribute("title"),schoolWrapper.animate(t?null:fadeLeftOutKF,fadeTiming).onfinish=()=>{document.querySelectorAll(".conflicting-background").forEach((e=>{e.style.opacity=1})),store.setSelection(data.find((e=>e.province===n.getAttribute("title")))),schoolWrapper.animate(fadeRightInKF,fadeTiming)}}function back(){store.isInSelection=!1,backButton.style.opacity=0,menuToggle.style.opacity=1,infoAreaTitle.style.transform="translateX(-40px)",map.style.transform="",map.style.translate="",lands.forEach((e=>{e.classList.remove("selected-hold"),e.classList.remove("unselected-hold")}))}function toggleMenu(){if(isMenuOpen)closeMenu();else{isMenuOpen=!0,menuToggleUpper.style.top="5px",menuToggleUpper.style.transform="rotate(45deg)",menuToggleMiddle.style.opacity="0",menuToggleLower.style.top="-5px",menuToggleLower.style.transform="rotate(-45deg)",document.querySelectorAll(".conflicting-background").forEach((e=>{e.style.opacity=0})),provinceList.style.height="100%",provinceListItems.forEach((e=>{e.style.opacity=1,e.style.transform="translateY(-40px)"}))}}function closeMenu(e=!1){isMenuOpen=!1,menuToggleUpper.style.top="",menuToggleUpper.style.transform="",menuToggleMiddle.style.opacity="",menuToggleLower.style.top="",menuToggleLower.style.transform="";let t=document.querySelectorAll(".conflicting-background");e||t.forEach((e=>{e.style.opacity=1})),provinceList.style.height="0%",provinceListItems.forEach((e=>{e.style.opacity=0,e.style.transform=""}))}lands.forEach((e=>{e.addEventListener("mouseover",(function(){lands.forEach((t=>{t!==e&&t.classList.add("unselected")}))})),e.addEventListener("mouseout",(function(){lands.forEach((e=>{e.classList.remove("unselected")}))}))})),provinceListItems.forEach((e=>{e.addEventListener("click",(function(){let t=e.querySelector("h2").textContent.trim();provinceClick({target:[...lands].find((e=>e.getAttribute("title")===t))},!0)}))})),lands.forEach((e=>{e.addEventListener("click",provinceClick);let t=data.find((t=>t.province===e.getAttribute("title")))?.num;null!=t&&(e.setAttribute("data-num",t),e.style.fill=`hsl(var(--theme-hue), ${20*t}%, 70%)`)})),backButton.addEventListener("click",back),menuToggle.addEventListener("click",toggleMenu);